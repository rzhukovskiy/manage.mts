{% extends "views/layouts/content.twig" %}

{% block leftmenu %}
    {% include "views/archive/left.twig" %}
{% endblock %}

{% block content %}
    <ul class="nav nav-tabs nav-tabs-employee">
        <li role="presentation" class="active">
            <a href="#">Заявки {{ translateGroup }}</a>
        </li>
    </ul>
    <div class="form-tabs">
        {% if group == "company" %}
            <a class="btn btn-default btn-primary" href="/archive/addCompany">Добавить</a>
        {% endif %}

        {% if group == "wash" %}
            <a class="btn btn-default btn-primary" href="/archive/addWash">Добавить</a>
        {% endif %}

        {% if group == "tires" %}
            <a class="btn btn-default btn-primary" href="/archive/addTires">Добавить</a>
        {% endif %}

        {% if group == "service" %}
            <a class="btn btn-default btn-primary" href="/archive/addService">Добавить</a>
        {% endif %}

        <hr />

        {% if Cities is empty %}
            <div style="margin-bottom: 30px;">
                <div class="form-tabs-title">
                    Город не указан
                </div>

                {{ this.getRequestsByCity(group, "", 0)|raw }}
            </div>
        {% endif %}

        {% set count = 0 %}
        {% for CurrentCity in Cities %}
            <div style="margin-bottom: 30px;">
                <div class="form-tabs-title">
                    {% if CurrentCity.isAddressCity() %}
                        {{ CurrentCity.address_city }}
                    {% else %}
                        Город не указан
                    {% endif %}
                </div>

                {% if CurrentCity.isAddressCity() %}
                    {{ this.getRequestsByCity(group, CurrentCity.address_city, count)|raw }}
                {% else %}
                    {{ this.getRequestsByCity(group, "", count)|raw }}
                {% endif %}
            </div>
            {% set count = count + 1 %}
        {% endfor %}
        <p>
            Итого заявок:
            <strong>{{ this.getRequestsCount(group) }}</strong>
        </p>
    </div>
{% endblock %}